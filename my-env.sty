%% personal config for some environments
%% C. Garion, 2012
%%
\NeedsTeXFormat{LaTeX2e}[1995/12/01]
\ProvidesPackage{my-env}[2013/06/11 v0.1
                 LaTeX package for TikZ configuration]

% for important env.
\RequirePackage{tikz}
\RequirePackage{mdframed}
\newenvironment{important}[1][]{%
  \vskip 1em
  \begin{minipage}[b]{0.125\linewidth}
    \begin{tikzpicture}[baseline={([yshift={-0.25\ht\strutbox}]current bounding box.north)}]
      \draw[line width=2pt, rounded corners=2pt,color=red] (0,0) --
      ++(0.7,-1) -- ++(-1.4,0) -- cycle;

      \fill[line width=2pt,rounded corners=2pt] (-0.075,-0.25) --
      ++(0.075,-0.5) -- ++(0.1,0.5) -- cycle;
      \fill (0,-0.85) circle[radius=2pt] ;
    \end{tikzpicture}
  \end{minipage}
  \begin{minipage}[t]{0.875\linewidth}
   \begin{mdframed}[%
      backgroundcolor={red!15}, topline=false, bottomline=false, rightline=false,
      skipabove=0.7\baselineskip, skipbelow=0.7\baselineskip,
      splitbottomskip=2pt, splittopskip=4pt, #1]%

}{\end{mdframed}\end{minipage}\vskip 1em}

% for tools
\RequirePackage{graphicx}
\newenvironment{tools}[1][]{%
  \vskip 1em
  \begin{minipage}[t]{0.125\linewidth}
    \vspace{0pt}
      \includegraphics[width=0.85\linewidth]{liftarn_Tools.png}
  \end{minipage}
  \begin{minipage}[t]{0.875\linewidth}
   \begin{mdframed}[%
      backgroundcolor={gray!15}, topline=false, bottomline=false, rightline=false,
      skipabove=0.7\baselineskip, skipbelow=0.7\baselineskip,
      splitbottomskip=2pt, splittopskip=4pt, #1]%

}{\end{mdframed}\end{minipage}\vskip 1em}

% for rules
\RequirePackage{graphicx}
\newenvironment{rules}[1][]{%
  \vskip 1em
  \begin{minipage}[t]{0.125\linewidth}
    \vspace{0pt}
      \includegraphics[width=0.85\linewidth]{policeman.png}
  \end{minipage}
  \begin{minipage}[t]{0.875\linewidth}
   \begin{mdframed}[%
      backgroundcolor={blue!15}, topline=false, bottomline=false, rightline=false,
      skipabove=0.7\baselineskip, skipbelow=0.7\baselineskip,
      splitbottomskip=2pt, splittopskip=4pt, #1]%

}{\end{mdframed}\end{minipage}\vskip 1em}

% reminder
\newenvironment{reminder}[1][]{%
  \vskip 1em
  \begin{minipage}[t]{0.125\linewidth}
    \vspace{0pt}
      \includegraphics[width=0.85\linewidth]{reminder.png}
  \end{minipage}
  \begin{minipage}[t]{0.875\linewidth}
   \begin{mdframed}[%
      backgroundcolor={yellow!15}, topline=false, bottomline=false, rightline=false,
      skipabove=0.7\baselineskip, skipbelow=0.7\baselineskip,
      splitbottomskip=2pt, splittopskip=4pt, #1]%

}{\end{mdframed}\end{minipage}\vskip 1em}

\newenvironment{remindersm}[1][]{%
  \vskip 1em
  \begin{minipage}[t]{0.06\linewidth}
    \vspace{0pt}
      \includegraphics[width=0.6\linewidth]{reminder.png}
  \end{minipage}
  \begin{minipage}[t]{0.9\linewidth}
   \begin{mdframed}[%
      backgroundcolor={yellow!15}, topline=false, bottomline=false, rightline=false,
      skipabove=0.7\baselineskip, skipbelow=0.7\baselineskip,
      splitbottomskip=2pt, splittopskip=4pt, #1]%

}{\end{mdframed}\end{minipage}\vskip 1em}

% adding stars in margin
\usepackage{forloop}
\usepackage{marginnote}
\newcounter{starcounter}
\newcommand{\stardif}[1]{%
\marginnote{($\forloop{starcounter}{0}{\value{starcounter} < #1}{{\star}})$}
}%

% set marks if not already defined
\newcommand{\setmark}[2]{%
  \ifundef{#1}{\def#1{#2}}{}%
}

% draw CS arrays
\newcounter{nodeidx}
\setcounter{nodeidx}{0}

\newif\ifcontinuearray

\pgfkeys{
  /myarray/.is family,
  /myarray,
  default/.style={
    sep distance = 0,
    array number = 0,
  },
  continue/.initial = false,
  sep distance/.estore in=\sepDistance,
  array number/.estore in=\arrayNum,
  continue/.is if=continuearray
}

\newcommand{\nodes}[2][]{%
  \pgfkeys{/myarray, default, #1}%
  \begin{scope}[\ifcontinuearray continue \else start \fi chain=my-array-temp-{\arrayNum} going right, node
    distance=\sepDistance]
    \foreach \num in {#2}{
      \node[minimum size=2em, draw, rectangle, on
      chain=my-array-temp-{\arrayNum}] (nodearray-\arrayNum-\arabic{nodeidx}) {\num};
      \stepcounter{nodeidx}
    }
  \end{scope}
}

\newcommand{\brckt}[4]{% from, to, lvl, text
  \draw (nodearray-#1.south west) ++($(-.1, -.1) + (-.1*#3, 0)$) -- ++($(0,-.1) + (0,-#3*1.25em)$) -- node [below] {#4} ($(nodearray-#2.south east) + (.1,-.1) + (.1*#3, 0) + (0,-.1) + (0,-#3*1.25em)$) -- ++($(0,#3*1.25em) + (0,.1)$);%
}
